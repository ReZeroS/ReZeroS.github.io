<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="ReZero"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="canonical" href="https://rezeros.github.io/2021/11/13/distributed-algo/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="Before that, think more."><meta property="og:type" content="article"><meta property="og:title" content="distributed algorithm"><meta property="og:url" content="https://rezeros.github.io/2021/11/13/distributed-algo/index.html"><meta property="og:site_name" content="ReZero"><meta property="og:description" content="Before that, think more."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://rezeros.github.io/images/redefine-og.webp"><meta property="article:published_time" content="2021-11-13T10:41:00.000Z"><meta property="article:modified_time" content="2025-04-15T23:03:26.477Z"><meta property="article:author" content="ReZero"><meta property="article:tag" content="distributed algorithm"><meta property="article:tag" content="distributed"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://rezeros.github.io/images/redefine-og.webp"><link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/redefine-favicon.svg"><title>distributed algorithm | ReZero&#39;s blog</title><link rel="stylesheet" href="/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/build/tailwind.css"><link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="/fonts/Geist/geist.css"><script src="/js/build/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"rezeros.github.io",root:"/",language:"en",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,delete_mask:!1,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:[]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"github",dark:"vs2015"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,pangu_js:!1,recommendation:{enable:!1,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!1},scroll_progress:{bar:!1,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:{enable:!0,custom_message:"Advance ruthlessly—whatever the cost!"},open_graph:{enable:!0,image:"/images/redefine-og.webp",description:"Before that, think more."},google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"Before that, think more.",subtitle:{text:[],hitokoto:{enable:!1,show_author:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!1,style:"default",links:{github:null,instagram:null,zhihu:null,twitter:null,email:null},qrs:{weixin:null}}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!1,version:"11.4.1"}},version:"2.8.2",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Categories:{path:"/categories/",icon:"fa-solid fa-folder"},Tags:{path:"/tags/",icon:"fa-solid fa-tags"}},search:{enable:!1,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:null,show_on_mobile:!0,links:null},article_date_format:"auto",excerpt_length:200,categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2022/8/17 11:45:14"},window.lang_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},window.data={masonry:!1}</script><link rel="stylesheet" href="/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/fontawesome/brands.min.css"><link rel="stylesheet" href="/fontawesome/solid.min.css"><link rel="stylesheet" href="/fontawesome/regular.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">Advance ruthlessly—whatever the cost!</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container flex flex-col justify-between min-h-dvh"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content transition-navbar"><div class="left"><a class="logo-title" href="/">ReZero&#39;s blog</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> HOME</a></li><li class="navbar-item"><a href="/categories/"><i class="fa-solid fa-folder fa-fw"></i> CATEGORIES</a></li><li class="navbar-item"><a href="/tags/"><i class="fa-solid fa-tags fa-fw"></i> TAGS</a></li></ul></div><div class="mobile"><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>HOME </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/categories/"><span>CATEGORIES </span><i class="fa-solid fa-folder fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/tags/"><span>TAGS </span><i class="fa-solid fa-tags fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">138</div><div class="label text-third-text-color text-sm">Tags</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">21</div><div class="label text-third-text-color text-sm">Categories</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">60</div><div class="label text-third-text-color text-sm">Posts</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body transition-fade-up"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">distributed algorithm</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/redefine-avatar.svg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">ReZero</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2021-11-13 10:41</span> <span class="mobile">2021-11-13 10:41</span> <span class="hover-info">Created</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2025-04-15 23:03:26</span> <span class="mobile">2025-04-15 23:03:26</span> <span class="hover-info">Updated</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/%E7%AE%97%E6%B3%95/">算法</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/distributed-algorithm/">distributed algorithm</a>&nbsp;</li><li>| <a href="/tags/distributed/">distributed</a>&nbsp;</li></ul></span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><h1 id="极客时间-分布式算法-整理"><a href="#极客时间-分布式算法-整理" class="headerlink" title="极客时间 分布式算法 整理"></a>极客时间 分布式算法 整理</h1><h2 id="Paxos"><a href="#Paxos" class="headerlink" title="Paxos"></a>Paxos</h2><h3 id="basic-paxos"><a href="#basic-paxos" class="headerlink" title="basic paxos"></a>basic paxos</h3><p>proposer： 发起请求的人，提议一个值，用于投票表决</p><p>acceptor：对每个提议的值进行投票</p><p>learner：被告知投票结果，接受达成共识的值。一般来说，学习者是数据备份节点，比如【Master-Slave】模型中的 Slave，被动地接受数据，容灾备份。</p><h4 id="stage"><a href="#stage" class="headerlink" title="stage"></a>stage</h4><h5 id="prepare"><a href="#prepare" class="headerlink" title="prepare"></a>prepare</h5><p>客户端发送准备请求，节点接受提案号，并作出响应【尚无提案】，承诺不接受比当前节点获得提案号小的提案号。如果接收到了小于当前节点提案号的提案，那么节点将不接受并且不做响应。</p><h5 id="Accept"><a href="#Accept" class="headerlink" title="Accept"></a>Accept</h5><p>客户端收到大多数节点的准备响应后发送接收请求，这时会提交提案号和提案值，如果客户端接收的准备响应为【尚无提案】，那么会将自己的提案值提交给节点。节点接收时，按准备阶段接收的小提案号的提案请求会被拒绝，大于等于的会被接受达成共识。</p><blockquote><p>如果集群中有学习者，当接受者通过提案就会通知所有学习者。学习者发现大多数接收者通过了某个提案就会学习（接受）该提案的值。</p></blockquote><p>Acceptor 保证三个承诺，具体来说：如果准备请求的提案编号，小于等于接受者已经响应的准备请求的提案编号，那么接受者将承诺不响应这个准备请求；<br>如果接受请求中的提案的提案编号，小于接受者已经响应的准备请求的提案编号，那么接受者将承诺不通过这个提案；<br>如果接受者之前有通过提案，那么接受者将承诺，会在准备请求的响应中，包含已经通过的最大编号的提案信息。</p><blockquote><p>basic paxos 能容忍一半以内的节点过账</p></blockquote><h3 id="multi-paxos"><a href="#multi-paxos" class="headerlink" title="multi-paxos"></a>multi-paxos</h3><h4 id="review"><a href="#review" class="headerlink" title="review"></a>review</h4><p>basic paxos 只能就单个值达成共识，一旦遇到为一系列值实现共识时就不管用了。</p><p>Multi-Paxos 是一种思想，不是算法。而Multi-Paxos 算法是一个统称，它是指基于 Multi-Paxos 思想，通过多个 Basic Paxos实例实现一系列值的共识的算法（比如 Chubby Multi-Paxos 实现、Raft 算法等）。</p><h4 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h4><p>如果多个提议者同时提交提案，可能出现因为提案冲突，在准备阶段没有提议者接收到大多数准备响应，协商失败，需要重新协商。你想象一下，一个 5 节点的集群，如果 3个节点作为提议者同时提案，就可能发生因为没有提议者接收大多数响应（比如 1 个提议者接收到 1 个准备响应，另外 2 个提议者分别接收到 2 个准备响应）而准备失败，需要重新协商。</p><p>2轮的 rpc 消耗较大，延迟高，不建议</p><h5 id="leader"><a href="#leader" class="headerlink" title="leader"></a>leader</h5><p>引入领导者，让领导者作为唯一的提议者，这样不存在多个提议者提议自然也就没有冲突了。</p><p>客户端【A，B，C】 &lt;-&gt; 【single leader】 &lt;-&gt; 节点【I, II】</p><h5 id="optimize"><a href="#optimize" class="headerlink" title="optimize"></a>optimize</h5><p>当领导者处于稳定状态时，省掉准备阶段，直接进入接受阶段。</p><h5 id="Chubby-的-Multi-Paxos-实现"><a href="#Chubby-的-Multi-Paxos-实现" class="headerlink" title="Chubby 的 Multi-Paxos 实现"></a>Chubby 的 Multi-Paxos 实现</h5><ol><li><p>引入了 leader</p></li><li><p>leader 是通过执行 basic paxos 投票选举产生的，并且运行过程中主节点通过续租来延长 租期(Lease)。实际场景中可能几天内都是同一个节点作为leader，leader故障后其他节点会选举新的leader，即leader一直存在且唯一。</p></li><li><p>实现了优化：稳定态省掉准备阶段</p><ol><li>稳定态：领导者节点上，序列中的命令是最新的，不再需要通过准备请求来发现之前被大多数节点通过的 提案，领导者可以独立指定提案中的值。</li><li>准备阶段的意义，是发现接受者节点上，已经通过的提案的值。如果在所有接受者节点上，都没有已经通过的提案了，这时，领导者就可以自己指定提案的值了，那么，准备阶 段就没有意义了，也就是可以省掉了。</li></ol></li><li><p>实现了成员变更，保证节点变更时集群平稳运行。</p></li><li><p>为了实现强一致性，读操作也只能在主节点上执行。</p></li></ol><h2 id="Raft"><a href="#Raft" class="headerlink" title="Raft"></a>Raft</h2><blockquote><p>从本质上说，Raft 算法是通过 [一切以领导者为准] 的方式，实现 [一系列值] 的共识和各节点日志的一致</p></blockquote><h3 id="role-which-also-called-server-state"><a href="#role-which-also-called-server-state" class="headerlink" title="role which also called server state"></a>role which also called server state</h3><ul><li>Follower: accept and process message from leader, and election itself as candidate when the heartbeat to leader timeout.</li><li>Candidate: send request vote(rpc message) to other nodes. It will be promoted to leader if only it won majority votes.</li><li>Leader：1. process write request 2. manage log copy 3. restrict them from initiating new elections by sending heartbeats</li></ul><blockquote><p>tips: Raft use strong leader model, only one leader can be existed.</p></blockquote><blockquote><p>跟随者：就相当于普通群众，默默地接收和处理来自领导者的消息，当等待领导者心跳 信息超时的时候，就主动站出来，推荐自己当候选人<br>候选人：候选人将向其他节点发送请求投票（RequestVote）RPC 消息，通知其他节点来投票，如果赢得了大多数选票，就晋升当领导者<br>领导者：蛮不讲理的霸道总裁，一切以我为准，平常的主要工作内容就是 3 部分，处理写请求、管理日志复制和不断地发送心跳信息，通知其他节点“我是领导者，我还活着，你们现在不要发起新的选举，找个新领导者来替代我。”</p></blockquote><h3 id="leader-election-process"><a href="#leader-election-process" class="headerlink" title="leader election process"></a>leader election process</h3><ol><li>all nodes begin as follower state with zero term. 在初始状态下，集群中所有的节点都是跟随者的状态。</li><li>raft has implemented random timeout feature. Raft 算法实现了随机超时时间的特性。</li><li>the node A has minimum timout will be the first one does not get the leader’s heart beat. 它会最先因为没有等到领导者的心跳信息，发生超时。</li><li>At this time, node A will increase its term and elect itself as candidate. It votes itself first and then send voteRequest to other node with asking them elect A as Leader.这个时候，节点 A 就增加自己的任期编号，并推举自己为候选人，先给自己投上一张选票，然后向其他节点发送请求投票 RPC 消息，请它们选举自己为领导者。</li><li>When other noe accept A request but does not vote at term 1, it will vote A and increase its term.如果其他节点接收到候选人 A 的请求投票 RPC 消息，在编号为 1 的这届任期内，也还没有进行过投票，那么它将把选票投给节点 A，并增加自己的任期编号</li><li>If candidate win majority votes in the ‘elect timeout’. it will be the leader at that term.如果候选人在选举超时时间内赢得了大多数的选票，那么它就会成为本届任期内新的领导者。</li><li>When node A as the leader, it will periodically send heart beat to inform other nodes it’s the leader and prevent followers initiating election. 节点 A 当选领导者后，他将周期性地发送心跳消息，通知其他服务器我是领导者，阻止跟随者发起新的选举。</li></ol><h5 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h5><ol><li>Q: How do nodes communicate ?<ol><li>RequestVote Rpc, send from candidate at election time, to inform other node send vote.</li><li>AppendEntries Rpc, send from leader to copy log and provide heart beat message.</li></ol></li><li>Q: What is the term ?<ol><li>Follower will increase its term when elect itself as candidate at waiting leader’s heart beat timeout. 跟随者在等待领导者心跳信息超时后，推举自己为候选人时，会增加自己的任期号.</li><li>When node get term field at vote request from other nodes, it will update its term to <code>max(its term, vote&#39;s term)</code></li><li>candidate or leader will be follower immediately when it receives greater term from other request.</li><li>node will reject the request if its term is smaller than node has.</li></ol></li><li>Q: rules in election?<ol><li>leader send heart beat to all followers.</li><li>follower elect itself when leader’s heartbeat timeout.</li><li>candidate will be leader if win the majority votes.</li><li>leader will be still leader except problem(leader dead or network delay) happened.</li><li>At each term every node will send no more than one vote with first come first got rule.<ol><li>在一次选举中，每一个服务器节点最多会对一个任期编号投出一张选票，并且按照“先来先服务”的原则进行投票。比如节点 C 的任期编号为 3，先收到了 1 个包含任期编号为 4 的投票请求（来自节点 A），然后又收到了 1 个包含任期编号为 4 的投票请求（来 自节点 B）。那么节点 C 将会把唯一一张选票投给节点 A，当再收到节点 B 的投票请求RPC 消息时，对于编号为 4 的任期，已没有选票可投了。</li></ol></li><li>When got the same term, follower with high log integrity will reject send vote to lower log integrity.<ol><li>当任期编号相同时，日志完整性高的跟随者（也就是最后一条日志项对应的任期编号值更大，索引号更大），拒绝投票给日志完整性低的候选人。</li><li>比如节点 B、C 的任期编号都是 3，节点 B 的最后一条日志项对应的任期编号为 3，而节点 C 为 2，那么当节点 C请求节点 B 投票给自己时，节点 B 将拒绝投票。</li></ol></li><li>The election is initiated by followers, who elect themselves as candidates; Majority votes refer to more than half of the votes of cluster members; The goal of the majority voting rule is to ensure that there is at most one leader in a given term of office.<ol><li>选举是跟随者发起的，推举自己为候选人；大多数选票是指集群成员半数以上的选票；大多数选票规则的目标，是为了保证在一个给定的任期内最多只有一个领导者。</li></ol></li></ol></li><li>Q: random timeout<ol><li>follower wait leader’s heartbeat.跟随者等待领导者心跳信息超时的时间间隔，是随机的</li><li>Election will be invalid if no candidate win majority vote. 当没有候选人赢得过半票数，选举无效了，这时需要等待一个随机时间间隔，也就是说，等待选举超时的时间间隔，是随机的</li></ol></li><li>Important notes:<ol><li>node with high log integrity can be the leader, log must be successive.</li><li>all methods include –term, leader’s heartbeat, random election timeout, first come will be first served vote rule, majority votes rule and so on are trying to promise only one leader at each term and decrease the possibility of failure situation.</li></ol></li></ol><h3 id="how-to-copy-log"><a href="#how-to-copy-log" class="headerlink" title="how to copy log"></a>how to copy log</h3><h4 id="log-entry"><a href="#log-entry" class="headerlink" title="log entry"></a>log entry</h4><p>Replica date exists in the form of logs, and log was constructed by log entry.</p><ol><li><p>command send from client’s request will be executed by status machine.</p></li><li><p>log index an increase digit number, identifies log entry.</p></li><li><p>the term number of leader who created this log entry.</p></li></ol><h4 id="copy-log"><a href="#copy-log" class="headerlink" title="copy log"></a>copy log</h4><ol><li>接收到客户端请求后，领导者基于客户端请求中的指令，创建一个新日志项，并附加到本地日志中。</li><li>领导者通过日志复制 RPC，将新的日志项复制到其他的服务器。</li><li>当领导者将日志项，成功复制到大多数的服务器上的时候，领导者会将这条日志项提交到它的状态机中。</li><li>领导者将执行的结果返回给客户端。</li><li>当跟随者接收到心跳信息，或者新的日志复制 RPC 消息后，如果跟随者发现领导者已经提交了某条日志项，而它还没提交，那么跟随者就将这条日志项提交到本地的状态机中。</li></ol><img lazyload src="/images/loading.svg" data-src="/2021/11/13/distributed-algo/log-1pc.png" title="copy log normal status"><h4 id="keep-consistency-of-log"><a href="#keep-consistency-of-log" class="headerlink" title="keep consistency of log"></a>keep consistency of log</h4><ol><li>领导者通过日志复制 RPC 消息，发送当前最新日志项到跟随者（为了演示方便，假设当前需要复制的日志项是最新的），这个消息的 PrevLogEntry 值为 7，PrevLogTerm 值为 4。</li><li>如果跟随者在它的日志中，找不到与 PrevLogEntry 值为 7、PrevLogTerm 值为 4 的日志项，也就是说它的日志和领导者的不一致了，那么跟随者就会拒绝接收新的日志项，并返回失败信息给领导者。</li><li>这时，领导者会递减要复制的日志项的索引值，并发送新的日志项到跟随者，这个消息的 PrevLogEntry 值为 6，PrevLogTerm 值为 3。</li><li>如果跟随者在它的日志中，找到了 PrevLogEntry 值为 6、PrevLogTerm 值为 3 的日志项，那么日志复制 RPC 返回成功，这样一来，领导者就知道在 PrevLogEntry 值为 6、PrevLogTerm 值为 3 的位置，跟随者的日志项与自己相同。</li><li>领导者通过日志复制 RPC，复制并更新覆盖该索引值之后的日志项（也就是不一致的日志项），最终实现了集群各节点日志的一致。</li><li><strong>领导者</strong>从来不会 <strong>覆盖或者删除自己的日志</strong>。</li></ol><h3 id="Member-Changes"><a href="#Member-Changes" class="headerlink" title="Member Changes"></a>Member Changes</h3><p>配置，建议这么理解：它就是在说集群是哪些节点组成的，是集群各节点地址信息的集合。比如节点 A、B、C 组成的集群，那么集群的配置就是[A, B, C]集合。</p><p>单节点变更，就是通过一次变更一个节点实现成员变更。不管旧的集群配置是怎么组成的，旧配置的“大多数”和新配置的“大多数”都会有一个节点是重叠的。</p><blockquote><p>需要你注意的是，在分区错误、节点故障等情况下，如果我们并发执行单节点变更，那么就可能出现一次单节点变更尚未完成，新的单节点变更又在执行，<br>导致集群出现 2 个领导者的情况。<br>如果你遇到这种情况，可以在领导者启动时，创建一个 NO_OP 日志项（也就是空日志项），只有当领导者将 NO_OP 日志项提交后，再执行成员变更请求</p></blockquote><h2 id="Gossip-protocol"><a href="#Gossip-protocol" class="headerlink" title="Gossip protocol"></a>Gossip protocol</h2><p>业务在可用性上比较敏感，比如监控主机和业务运行的告警系统。这个时候，相信你希望自己的系统能在极端情况下（比如集群中只有一个节点在运行）也能运行。<br>回忆了二阶段提交协议和 Raft 算法之后，你发现它们都需要全部节点或者大多数节点正常运行，才能稳定运行。可以通过 Gossip 协议实现这个目标。</p><h3 id="直接邮寄（Direct-Mail）"><a href="#直接邮寄（Direct-Mail）" class="headerlink" title="直接邮寄（Direct Mail）"></a>直接邮寄（Direct Mail）</h3><p>直接发送更新数据，当数据发送失败时，将数据缓存下来，然后重传。但注意下缓存队列满了丢数据的问题，只采用直接邮寄是无法实现最终一致性的，想最终一致得依靠反熵</p><h3 id="反熵（Anti-entropy）"><a href="#反熵（Anti-entropy）" class="headerlink" title="反熵（Anti-entropy）"></a>反熵（Anti-entropy）</h3><p>反熵指的是集群中的节点，每隔段时间就随机选择某个其他节点，然后通过互相交换自己的所有数据来消除两者之间的差异，实现数据的最终一致性</p><ul><li>推：是将自己的所有副本数据，推给对方，修复对方副本中的熵：</li><li>拉：是拉取对方的所有副本数据，修复自己副本中的熵</li><li>推拉：同时修复自己副本和对方副本中的熵</li></ul><p>反熵需要节点两两交换和比对自己所有的数据，执行反熵时通讯成本会很高，所以不建议在实际场景中频繁执行反熵， 并且可以通过引入校验和（Checksum）等机制，降低需要对比的数据量和通讯消息等。</p><p>虽然反熵很实用，但是执行反熵时，相关的节点都是已知的，而且节点数量不能太多，如果 是一个动态变化或节点数比较多的分布式环境（比如在 DevOps 环境中检测节点故障，并动态维护集群节点状态），这时反熵就不适用了。<br>那么当你面临这个情况要怎样实现最终一致性呢？答案就是谣言传播。</p><h3 id="谣言传播（Rumor-mongering）"><a href="#谣言传播（Rumor-mongering）" class="headerlink" title="谣言传播（Rumor mongering）"></a>谣言传播（Rumor mongering）</h3><p>当一个节点有了新数据后，这个节点变成活跃状态，并周期性地联系其他节点向其发送新数据，直到所有的节点都存储了该新数据（非常具有传染性）</p><h3 id="如何使用-Anti-entropy-实现最终一致：-InfluxDB-的反熵样例"><a href="#如何使用-Anti-entropy-实现最终一致：-InfluxDB-的反熵样例" class="headerlink" title="如何使用 Anti-entropy 实现最终一致： InfluxDB 的反熵样例"></a>如何使用 Anti-entropy 实现最终一致： InfluxDB 的反熵样例</h3><p>在自研 InfluxDB 中，一份数据副本是由多个分片组成的，也就是实现了数据分片，三节点三副本的集群，就像下图的样子：</p><p>NodeA:Shard]1,S2; NodeB:S1,S2; NodeC:S1,S2</p><p>Node ABC 上分片的数据是一致的。</p><h5 id="数据丢失的两种功能情况"><a href="#数据丢失的两种功能情况" class="headerlink" title="数据丢失的两种功能情况"></a>数据丢失的两种功能情况</h5><ol><li>缺失分片：也就是说，在某个节点上整个分片都丢失了。</li><li>节点之间的分片不一致：也就是说，节点上分片都存在，但里面的数据不一样，有数据丢失的情况发生。</li></ol><p>第一种情况修复起来不复杂，我们只需要将分片数据，通过 RPC 通讯，从其他节点上拷贝过来就可以了。</p><p>第二种需要设计一个闭环的流程，按照一个顺序修复，执行完流程后，也就是实现了一致性了。<br>它是按照一定顺序来修复节点的数据差异，先随机选择一个节点，然后循环修复，每个节点生成 <strong>自己节点有、下一个节点没有的差异数据</strong>，发送给下一个节点，进行修复.<br>数据修复的起始节点为节点 A，数据修复是按照顺时针顺序，循环修复的。<br>需要你注意的是，最后节点 A 又对节点 B 的数据执行了一次数据修复操作，因为只有这样，节点 C 有、节点 B 缺失的差异数据，才会同步到节点 B 上.</p><p>非随机的原因是希望能在一个确定的时间范围内实现数据副本的最终一致性，而不是基于随机性的概率，在一个不确定的时间范围内实现数据副本的最终一致性</p><p>最后需要你注意的是，因为反熵需要做一致性对比，很消耗系统性能，所以建议你将是否启用反熵功能、执行一致性检测的时间间隔等，做成可配置的，能在不同场景中按需使用。</p><h2 id="Quorum-NWR"><a href="#Quorum-NWR" class="headerlink" title="Quorum NWR"></a>Quorum NWR</h2><p>适用于已经实现AP了，临时的需求需要C（最终一致性），那么可以采用这个算法，当 <code>W + R &gt; N</code> 时，就可以实现强一致性</p><p>N 表示副本数，又叫做复制因子（Replication Factor）。即 N 表示集群中同一份数据有多少个副本。<br>例如在三节点的集群中，DATA-1 有 2 个副本，DATA-2 有 3 个副本，DATA-3 有 1 个副本。也就是说，副本数可以不等于节点数，不同的数据可以有不同的副本数。</p><p><code>Quorum NWR</code> 需要实现自定义副本的功能。也就是说，用户可以自定义指定数据的副本数。</p><p>W，又称写一致性级别（Write Consistency Level），表示成功完成 W 个副本更新，才完成该份数据的写操作</p><p>R，又称读一致性级别（Read Consistency Level），表示读取一个数据对象时需要读 R 个副本。</p><p>W + R &gt; N 代表 WR必有交集，交集点就是最新的数据</p><h4 id="如何实现-Quorum-NWR"><a href="#如何实现-Quorum-NWR" class="headerlink" title="如何实现 Quorum NWR"></a>如何实现 Quorum NWR</h4><p>InfluxDB 中创建保留策略时设置指定DB的副本数可用命令<br><code>create retention policy “rp_one_day” on “telegraf” duration 1d replication 3</code><br>通过 <code>replication</code> 参数指定了数据库 <code>telegraf</code> 的副本数为3</p><p>副本数不能超过节点数据。你可以这么理解，多副本的意义在于冗余备份，如果副本数超过节点数，就意味着在一个节点上会存在多个副本，那么这时冗余备份的意义就不大了。<br>比如机器故障时，节点上的多个副本是同时被影响的。</p><p>InfluxDB 企业版，支持“any、one、quorum、all”4 种写一致性级别：</p><ol><li>any：任何一个节点写入成功后，或者接收节点已将数据写入 Hinted-handoff 缓存（也就是写其他节点失败后，本地节点上缓存写失败数据的队列）后，就会返回成功给客户端。</li><li>one：任何一个节点写入成功后，立即返回成功给客户端，不包括成功写入到 Hinted-handoff 缓存。</li><li>quorum：当大多数节点写入成功后，就会返回成功给客户端。此选项仅在副本数大于 2时才有意义，否则等效于 all。</li><li>all：仅在所有节点都写入成功后，返回成功。</li></ol><p>对时序数据库而言，读操作常会拉取大量数据，查询性能是挑战，是必须要考虑优化的，因此，在 InfluxDB 企业版中，不支持读一致性级别，只支持写一致性级别。<br>另外，我们可以通过设置写一致性级别为 all，来实现强一致性。</p><blockquote><p>N 决定了副本的冗余备份能力；<br>如果设置 W &#x3D; N，读性能比较好；<br>如果设置 R &#x3D; N，写性能比较好；<br>如果设置 W &#x3D; (N + 1) &#x2F; 2、R &#x3D; (N + 1) &#x2F; 2，容错能力比较好，能容忍少数节点（也就是 (N - 1) &#x2F; 2）的故障。</p></blockquote><h2 id="PBFT"><a href="#PBFT" class="headerlink" title="PBFT"></a>PBFT</h2><p>口信消息法有个非常致命的缺陷（为什么落地困难）。如果将军数为 n、叛将数为 f，那么算法需要递归协商 f+1 轮，消息复杂度为 O(n ^ (f + 1))，消息数量指数级暴增。<br>你可以想象一下， 如果叛将数为 64，消息数已经远远超过 int64 所能表示的了，这是无法想象的。</p><h3 id="PBFT-如何达成共识"><a href="#PBFT-如何达成共识" class="headerlink" title="PBFT 如何达成共识"></a>PBFT 如何达成共识</h3><p><strong>在这里我想说的是， PBFT 算法是通过签名（或消息认证码 MAC）约束恶意节点的行为， 也就是说，每个节点都可以通过验证消息签名确认消息的发送来源，一个节点无法伪造另外一个节点的消息。最终，基于大多数原则（2f + 1）实现共识的。</strong></p><p>需要你注意的是，最终的共识是否达成，客户端（苏秦）是会做判断的，如果客户端在指定时间内未收到请求对应的 f + 1 相同响应，就认为集群出故障了，共识未达成，客户端会重新发送请求。</p><p>另外需要你注意的是，PBFT 算法通过视图变更（View Change）的方式，来处理主节点（赵国将领）作恶，当发现主节点在作恶时，会以“轮流上岗”方式，推举新的主节点。</p><h4 id="消息消耗仍然较高"><a href="#消息消耗仍然较高" class="headerlink" title="消息消耗仍然较高"></a>消息消耗仍然较高</h4><p>最后我想说的是，尽管 PBFT 算法相比口信消息型拜占庭之解已经有了很大的优化，将消息复杂度从 O(n ^ (f + 1)) 降低为 O(n ^ 2)，能在实际场景中落地，并解决实际的共识问题。<br>但 PBFT 还是需要比较多的消息。比如在 13 节点集群中（f 为 4）。</p><ul><li>请求消息：1</li><li>预准备消息：3f &#x3D; 12</li><li>准备消息：3f * (3f - f) &#x3D; 96</li><li>提交消息：(3f - f + 1) * (3f + 1)&#x3D; 117</li><li>回复消息：3f - 1 &#x3D; 11</li><li>也就是说，一次共识协商需要 237 个消息，你看，消息数还是蛮多的，所以我推荐你，在</li><li>中小型分布式系统中使用 PBFT 算法。</li></ul><p>PBFT 算法实现的是一系列值的共识，而不是口信模型的单值的共识</p><p>相比 Raft 算法完全不适应有人作恶的场景，PBFT 算法能容忍 (n - 1)&#x2F;3 个恶意节点 (也可以是故障节点)。<br>另外，相比 PoW 算法，PBFT 的优点是不消耗算力，所以在日常实践中，PBFT 比较适用于相对“可信”的场景中，比如联盟链。<br>需要你注意的是，PBFT 算法与 Raft 算法类似，也存在一个“领导者”（就是主节点）， 同样，集群的性能也受限于“领导者”。<br>另外，O(n ^ 2) 的消息复杂度，以及随着消息数的增加，网络时延对系统运行的影响也会越大，这些都限制了运行 PBFT 算法的分布式系统的规模，也决定了 PBFT 算法适用于中小型分布式系统。</p><h2 id="PoW算法"><a href="#PoW算法" class="headerlink" title="PoW算法"></a>PoW算法</h2><p>背景： PBFT 算法虽然能防止坏人作恶，但只能防止少数的坏人作恶，也就是 (n - 1) &#x2F; 3 个坏人 (其中 n 为节点数)。<br>可如果区块链也只能防止一定比例的坏人作恶，那就麻烦了，因为坏人可以不断增加节点数，轻松突破 (n - 1) &#x2F; 3 的限制。</p><p>区块链通过工作量证明（Proof of Work）增加了坏人作恶的成本。</p><h3 id="工作量证明-Proof-Of-Work）"><a href="#工作量证明-Proof-Of-Work）" class="headerlink" title="工作量证明 (Proof Of Work）"></a>工作量证明 (Proof Of Work）</h3><p>我们给出的工作量要求是，基于一个基本的字符串（比如”geektime”），你可以在这个字符串后面添加一个整数值，然后对变更后（添加整数值) 的字符串进行 SHA256 哈希运算，<br>如果运算后得到的哈希值（16 进制形式）是以”0000”开头的，就验证通过。为了达到这个工作量证明的目标，我们需要不停地递增整数值，一个一个试，对得到的新字符串进行SHA256 哈希运算。<br>按照这个规则，我们需要经过 35024 次计算，才能找到恰好前 4 位为 0 的哈希值。</p><h3 id="区块链如何实现-PoW-算法的"><a href="#区块链如何实现-PoW-算法的" class="headerlink" title="区块链如何实现 PoW 算法的"></a>区块链如何实现 PoW 算法的</h3><p>区块的组成</p><ul><li>区块头（Block Head）：区块头主要由上一个区块的哈希值、区块体的哈希值、4 字节的随机数（nonce）等组成的。</li><li>区块体（Block Body）：区块包含的交易数据，其中的第一笔交易是 Coinbase 交易，这是一笔激励矿工的特殊交易。</li></ul><p>拥有 80 字节固定长度的区块头，就是用于区块链工作量证明的哈希运算中输入字符串，而且通过双重 SHA256 哈希运算<br>（也就是对 SHA256 哈希运算的结果，再执行一次哈希运算），计算出的哈希值，只有小于目标值（target），才是有效的，否则哈希值是无效的，必须重算。</p></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>Title:</strong> distributed algorithm</li><li><strong>Author:</strong> ReZero</li><li><strong>Created at :</strong> 2021-11-13 10:41:00</li><li><strong>Updated at :</strong> 2025-04-15 23:03:26</li><li><strong>Link:</strong> https://rezeros.github.io/2021/11/13/distributed-algo/</li><li><strong>License: </strong>This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.</li></ul></div></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/distributed-algorithm/">#distributed algorithm</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/distributed/">#distributed</a>&nbsp;</li></ul><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2021/12/15/log4jbug/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">Log4j poc</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2021/10/19/arthas/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">Arthas</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div><div class="comment-container px-2 sm:px-6 md:px-8 pb-8"><div class="comments-container mt-10 w-full"><div id="comment-anchor" class="w-full h-2.5"></div><div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">Comments</div><div id="giscus-container"></div><script data-swup-reload-script defer>async function loadGiscus(){const t={src:"https://giscus.app/client.js","data-repo":"rezeros/rezeros.github.io","data-repo-id":"MDEwOlJlcG9zaXRvcnkxNjk3MzU3NzA=","data-category":"Announcements","data-category-id":"DIC_kwDOCh32Ws4Co2GO","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"1","data-theme":"preferred_color_scheme","data-lang":"en","data-input-position":"bottom","data-loading":"not-lazy",crossorigin:"anonymous",async:!0},a=document.createElement("script");for(const e in t)a.setAttribute(e,t[e]);document.getElementById("giscus-container").appendChild(a)}{let t=setTimeout(()=>{loadGiscus(),clearTimeout(t)},1e3)}</script></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">On this page</div><div class="page-title">distributed algorithm</div><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4-%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95-%E6%95%B4%E7%90%86"><span class="nav-text">极客时间 分布式算法 整理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Paxos"><span class="nav-text">Paxos</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#basic-paxos"><span class="nav-text">basic paxos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#multi-paxos"><span class="nav-text">multi-paxos</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Raft"><span class="nav-text">Raft</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#role-which-also-called-server-state"><span class="nav-text">role which also called server state</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#leader-election-process"><span class="nav-text">leader election process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-to-copy-log"><span class="nav-text">how to copy log</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Member-Changes"><span class="nav-text">Member Changes</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gossip-protocol"><span class="nav-text">Gossip protocol</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E9%82%AE%E5%AF%84%EF%BC%88Direct-Mail%EF%BC%89"><span class="nav-text">直接邮寄（Direct Mail）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E7%86%B5%EF%BC%88Anti-entropy%EF%BC%89"><span class="nav-text">反熵（Anti-entropy）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%A3%E8%A8%80%E4%BC%A0%E6%92%AD%EF%BC%88Rumor-mongering%EF%BC%89"><span class="nav-text">谣言传播（Rumor mongering）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Anti-entropy-%E5%AE%9E%E7%8E%B0%E6%9C%80%E7%BB%88%E4%B8%80%E8%87%B4%EF%BC%9A-InfluxDB-%E7%9A%84%E5%8F%8D%E7%86%B5%E6%A0%B7%E4%BE%8B"><span class="nav-text">如何使用 Anti-entropy 实现最终一致： InfluxDB 的反熵样例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Quorum-NWR"><span class="nav-text">Quorum NWR</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PBFT"><span class="nav-text">PBFT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PBFT-%E5%A6%82%E4%BD%95%E8%BE%BE%E6%88%90%E5%85%B1%E8%AF%86"><span class="nav-text">PBFT 如何达成共识</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PoW%E7%AE%97%E6%B3%95"><span class="nav-text">PoW算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E9%87%8F%E8%AF%81%E6%98%8E-Proof-Of-Work%EF%BC%89"><span class="nav-text">工作量证明 (Proof Of Work）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E9%93%BE%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0-PoW-%E7%AE%97%E6%B3%95%E7%9A%84"><span class="nav-text">区块链如何实现 PoW 算法的</span></a></li></ol></li></ol></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2022</span> - 2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration:0.5s;color:#f54545"></i>&nbsp;&nbsp;<a href="/">ReZero</a><p class="post-count space-x-0.5"><span>60 posts in total</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">VISITOR COUNT</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">TOTAL PAGE VIEWS</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span> <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span></div><div>Blog up for <span class="odometer" id="runtime_days"></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li><li class="go-comment"><i class="fa-regular fa-comments"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div></main><script src="/js/build/libs/Swup.min.js"></script><script src="/js/build/libs/SwupSlideTheme.min.js"></script><script src="/js/build/libs/SwupScriptsPlugin.min.js"></script><script src="/js/build/libs/SwupProgressPlugin.min.js"></script><script src="/js/build/libs/SwupScrollPlugin.min.js"></script><script src="/js/build/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script src="/js/build/tools/imageViewer.js" type="module"></script><script src="/js/build/utils.js" type="module"></script><script src="/js/build/main.js" type="module"></script><script src="/js/build/layouts/navbarShrink.js" type="module"></script><script src="/js/build/tools/scrollTopBottom.js" type="module"></script><script src="/js/build/tools/lightDarkSwitch.js" type="module"></script><script src="/js/build/layouts/categoryList.js" type="module"></script><script src="/js/build/tools/codeBlock.js" type="module"></script><script src="/js/build/layouts/lazyload.js" type="module"></script><script src="/js/build/tools/runtime.js"></script><script src="/js/build/libs/odometer.min.js"></script><link rel="stylesheet" href="/assets/odometer-theme-minimal.css"><script src="/js/build/libs/Typed.min.js"></script><script src="/js/build/plugins/typed.js" type="module"></script><script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script><script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script><script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script><script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script><script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script></body></html>